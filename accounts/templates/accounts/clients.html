{% extends 'base.html' %}
{% load static %}

{% block title %}Клиенты | Volida{% endblock %}

{% block page_title %}Клиенты{% endblock %}

{% block content %}
<div class="action-bar">
    <div class="search-container">
        <input type="text" class="search-input" placeholder="Поиск">
        <button class="btn-dropdown">
            <i class="fas fa-chevron-down"></i>
        </button>
    </div>
    <div class="action-buttons">
        <button class="btn btn-icon">
            <i class="fas fa-search"></i>
        </button>
        <button class="btn btn-icon">
            <i class="fas fa-trash"></i>
        </button>
    </div>
    <button class="btn btn-create" id="createClientBtn">
        <i class="fas fa-plus"></i> Создать
    </button>
</div>

<div class="table-container">
    <table class="data-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Название</th>
                <th>Телефон</th>
                <th>Адрес</th>
                <th>Баланс</th>
            </tr>
        </thead>
        <tbody>
            <tr data-id="1" class="client-row">
                <td>92</td>
                <td>ANSOR MARKET UCH MCHI</td>
                <td>+998999999999</td>
                <td>г.Ташкент Алайский базар, 2ой ряд после молочки</td>
                <td class="negative">- 10 000 000</td>
            </tr>
            <tr data-id="2" class="client-row">
                <td>85</td>
                <td>OOO BALANS PERFECTION</td>
                <td>+998911234567</td>
                <td>г.Ташкент, ул. Мирзо-Улугбек, д.32</td>
                <td class="positive">+ 5 300 000</td>
            </tr>
            <tr data-id="3" class="client-row">
                <td>73</td>
                <td>ЧП MAXSULOT SAVDO BIZNES</td>
                <td>+998972345678</td>
                <td>г.Самарканд, ул. Рудаки, д.15</td>
                <td class="negative">- 8 400 000</td>
            </tr>
            <tr data-id="4" class="client-row">
                <td>68</td>
                <td>MARKET OYBEK</td>
                <td>+998993456789</td>
                <td>г.Ташкент, ул. Шота Руставели, д.55</td>
                <td class="positive">+ 12 750 000</td>
            </tr>
        </tbody>
    </table>
</div>

<!-- Пагинация -->
<div class="pagination-container">
    <ul class="pagination">
        <li><a href="#" class="previous"><i class="fas fa-angle-left"></i></a></li>
        <li><a href="#" class="page-link">5</a></li>
        <li><a href="#" class="page-link">...</a></li>
        <li><a href="#" class="page-link">10</a></li>
        <li class="active"><a href="#" class="page-link">11</a></li>
        <li><a href="#" class="page-link">12</a></li>
        <li><a href="#" class="page-link">13</a></li>
        <li><a href="#" class="page-link">14</a></li>
        <li><a href="#" class="page-link">15</a></li>
        <li><a href="#" class="page-link">16</a></li>
        <li><a href="#" class="page-link">...</a></li>
        <li><a href="#" class="page-link">428</a></li>
        <li><a href="#" class="next"><i class="fas fa-angle-right"></i></a></li>
    </ul>
</div>

<!-- Модальное окно для создания клиента -->
<div class="modal" id="createClientModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Создание клиента</h2>
            <button class="close-btn" id="closeModal">&times;</button>
        </div>
        <div class="modal-body">
            <form id="clientForm">
                <div class="form-group">
                    <label for="clientName">Название клиента:</label>
                    <input type="text" id="clientName" name="clientName" class="form-control" placeholder="Введите название клиента...">
                </div>
                
                <div class="form-group">
                    <label for="director">Директор:</label>
                    <input type="text" id="director" name="director" class="form-control" placeholder="Введите ФИО директора...">
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="inn">ИНН:</label>
                            <input type="text" id="inn" name="inn" class="form-control" placeholder="Введите ИНН...">
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="account">Расчетный счет:</label>
                            <input type="text" id="account" name="account" class="form-control" placeholder="Введите расчетный счет...">
                        </div>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="phone">Номер телефона:</label>
                            <input type="text" id="phone" name="phone" class="form-control" placeholder="Введите номер...">
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="address">Адрес:</label>
                            <input type="text" id="address" name="address" class="form-control" placeholder="Введите адрес...">
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelClient">Отмена</button>
            <button class="btn btn-primary" id="saveClient">
                <i class="fas fa-save"></i> Сохранить
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
    /* Стили для таблицы клиентов */
    .data-table {
        border-collapse: separate;
        border-spacing: 0;
        width: 100%;
        border: 1px solid #e0e0e0;
        border-radius: 4px;
        overflow: hidden;
    }
    
    .data-table th,
    .data-table td {
        padding: 16px;
        text-align: left;
        border-bottom: 1px solid #e0e0e0;
        border-right: 1px solid #e0e0e0;
    }
    
    .data-table th:last-child,
    .data-table td:last-child {
        border-right: none;
    }
    
    .data-table thead {
        background-color: #f5f7fa;
    }
    
    .data-table tbody tr:last-child td {
        border-bottom: none;
    }
    
    .client-row {
        cursor: pointer;
        transition: background-color 0.2s;
    }
    
    .client-row:hover {
        background-color: #f0f7ff;
    }
    
    .positive {
        color: #28a745;
        font-weight: 500;
    }
    
    .negative {
        color: #dc3545;
        font-weight: 500;
    }
</style>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Модальное окно для создания клиента
        const createClientBtn = document.getElementById('createClientBtn');
        const createClientModal = document.getElementById('createClientModal');
        const closeModal = document.getElementById('closeModal');
        const cancelClient = document.getElementById('cancelClient');
        
        // Открыть модальное окно
        createClientBtn.addEventListener('click', function() {
            createClientModal.classList.add('show');
        });
        
        // Закрыть модальное окно
        function closeClientModal() {
            createClientModal.classList.remove('show');
        }
        
        closeModal.addEventListener('click', closeClientModal);
        cancelClient.addEventListener('click', closeClientModal);
        
        // Закрыть при клике вне модального окна
        createClientModal.addEventListener('click', function(e) {
            if (e.target === createClientModal) {
                closeClientModal();
            }
        });
        
        // Предотвращение отправки формы по умолчанию
        document.getElementById('clientForm').addEventListener('submit', function(e) {
            e.preventDefault();
        });
        
        // Сохранение клиента (заглушка)
        document.getElementById('saveClient').addEventListener('click', function() {
            alert('Функционал сохранения будет реализован в будущем с интеграцией базы данных.');
            closeClientModal();
        });
        
        // Клик по строке таблицы - перенаправление на страницу деталей клиента
        const clientRows = document.querySelectorAll('.client-row');
        clientRows.forEach(row => {
            row.addEventListener('click', function() {
                const clientId = this.getAttribute('data-id');
                window.location.href = `/clients/view/${clientId}/`;
            });
        });
    });
</script>
{% endblock %}